{"name":"Ima2","tagline":"Illumina Methylation Analyzer 2 for ILLUMINA 450k HumanMethylation Beadchip","body":"IMA2 (Illumina Methylation Analyzer 2)\r\n======================================\r\n[![Build Status](https://travis-ci.org/mcanouil/IMA2.svg?branch=master)](https://travis-ci.org/mcanouil/IMA2)\r\n\r\n*IMA2 is based on IMA package (3.1.2) at [http://rforge.net/IMA/](http://rforge.net/IMA/).*\r\n\r\n>**Aurhors:**\r\n>Wang D, Yan L, Hu Q, Sucheston LE, Higgins MJ, Ambrosone CB, Johnson CS, Smiraglia DJ, Liu S.\r\n>*IMA: an R package for high-throughput analysis of Illumina's 450K Infinium methylation data.*\r\n>Bioinformatics. 2012 Mar 1;28(5):729-30\r\n\r\n\r\nIMA2 is a package designed to automate the pipeline for exploratory analysis and summarization of site-level and region-level methylation changes in epigenetic studies utilizing the 450K DNA methylation microarray\r\nIMA2 automates the tasks commonly required for the exploratory analysis and summarization of epigenetic data sets utilizing the 450K DNA methylation microarray. The package makes use of Illumina methylation annotation for region definition, as well as several Bioconductor packages for various preprocessing and differential testing steps. There are two major differences between IMA2 and existing packages for Infinium methylation microarray analysis. First, instead of analyzing CpG site only, IMA2 provide both site-level and region-level methylation analysis. Second, instead of manually calling individual R functions at the command line, IMA2 provides a pipeline which automate the tasks commonly required for the exploratory analysis and summarization of 450K microarray data. The user can either run the pipeline with default setting or specify optional routes in the parameter file of pipeline.\r\n\r\nThe main purpose of developing IMA2 package is to provide a range of commonly used analysis options for potential users to perform exploratory analysis and summarization of 450K microarray data in an automatic way. It is the best interest for the users to consult experienced bioinformatician/statistician about which specific analysis option should be chosen for their 450k microarray data. Written in open source R environment, it provides the flexibility for users to adopt, extend and customize the functionality for their specific needs. It can be used as an automatic pipeline to analyze specific regions as well as specific sites for downstream functional exploration and hypothesis generation.\r\n\r\n\r\n\r\n## Example\r\n### 1. Install and load IMA2\r\nTo install the latest development builds directly from GitHub, run this instead:\r\n```r\r\nif (!require(\"devtools\")) { install.packages(\"devtools\") } else {}\r\ndevtools::install_github(\"mcanouil/IMA2\")\r\n```\r\nLoad **IMA2**: ***(Not on CRAN yet)***\r\n```r\r\nlibrary(IMA2)\r\n```\r\n\r\n### 2. Options\r\n#### 2.1. Read data\r\n```r\r\n# Specfiy the original methylation data produced by the GenomeStudio\r\nMethyFileName <- \"../data/SampleMethFinalReport_Smiraglia.txt\"\r\n\r\n# Specify the phenotype for each sample\r\nPhenoFileName <- \"../data/SamplePhenotype.txt\"\r\n```\r\n\r\n#### 2.2. Preprocessing\r\n```r\r\n# The cutoff for sample-level detection Pvalue\r\nsamplefilterdetectP <- 1e-5\r\n\r\n# The percent of loci with detection Pvalue less than \"samplefilterdetectP\"\r\n# in each sample\r\nsamplefilterperc <- 0.75\r\n\r\n# The cutoff for site-level detection Pvalue\r\nsitefilterdetectP <- 0.05\r\n\r\n# The percent of samples with detection Pvalue less than \"sitefilterdetectP\"\r\n# for each site\r\nsitefilterperc <- 0.5\r\n\r\n# Remove the sites containing missing beta value\r\nna.omit <- TRUE\r\n\r\n# Remove the sites on chromosome X\r\nXYchrom <- FALSE\r\n\r\n# If TRUE, peak correction is performed\r\npeakcorrection <- FALSE\r\n\r\n# If TRUE, quantile normalization performed\r\nnormalization <- FALSE\r\n\r\n# If FALSE, no transform is performed; if \"arcsinsqr\", arcsin square root\r\n# transformation is performed; if \"logit\", logit transformation is performed\r\ntransfm <- FALSE\r\n\r\n# If FALSE, don't filter sites by the difference of group beta value. Otherwise,\r\n# remove the sites with beta value difference smaller than the specified value\r\nlocidiff <- FALSE\r\n\r\n# Specify which two groups are considered to check the loci difference\r\n# (if \"locidiff\" is not true)\r\nlocidiffgroup <- c(\"g1\", \"g2\")\r\n\r\n# If FALSE, keep the loci whose methylation level are measured by probes\r\n# containing SNP(s) at/near the targeted CpG site; otherwise,\r\n# filter out the list of SNP containing loci\r\n# by specifying the snp file name and location\r\nsnpfilter <- FALSE\r\n\r\n# A list of SNP-containing probes (based on dbSNP v132) could be accessed\r\n# by the command:\r\nsnpfilter <- system.file(\"extdata/snpsites.txt\", package = \"IMA\")\r\n```\r\n\r\n#### 2.3. Site test\r\n```r\r\n# Other options of differential testing methods:\r\n#\"wilcox\"/\"pooled\"/\"satterthwaite\" for the comparison between two group\r\ntestmethod <- \"limma\"\r\n\r\n# If \"ON\", covariates is continuous variable\r\nconcov <- \"OFF\"\r\n\r\n# Specify the case group index in the sample.txt file (if \"concov\" is \"ON\")\r\ngcase <- \"g2\"\r\n\r\n# Specify the control group index in the sample.txt file (if \"concov\" is \"ON\")\r\ngcontrol <- \"g1\"\r\n\r\n# Options for multiple testing correction.\r\n#The user can choose the methods provided by p.adjust function of R stat package\r\nPadj <- \"BH\"\r\n\r\n# Options for deriving an index of overall methylation value of each region.\r\n#mean/median/tbrm: \"tbrm\" is Tukey's Biweight robust average\r\nindexmethod <- \"mean\"\r\n\r\n# If true, the differential test methods would change to the\r\n# corresponding paired-test methods\r\npaired <- FALSE\r\n```\r\n\r\n#### 2.4. Output the differential sites.\r\n```r\r\n# cut off for raw pvalue\r\nrawpcut <- NULL\r\n\r\n# cut off for adjusted pvalue\r\nadjustpcut <- NULL\r\n\r\n# cut off for beta value difference\r\nbetadiffcut <- NULL\r\n```\r\n\r\n### 3. Analysis\r\n```r\r\n# load the data\r\ndata <- IMA2.methy450R(\r\n    fileName = MethyFileName,\r\n    columnGrepPattern = list(beta = \".AVG_Beta\", detectp = \".Detection.Pval\"),\r\n    groupfile = PhenoFileName\r\n)\r\n\r\n# QC filtering\r\ndataf <- IMA2.methy450PP(\r\n    data,\r\n    na.omit = na.omit,\r\n    normalization = normalization,\r\n    peakcorrection = peakcorrection,\r\n    transfm = transfm,\r\n    samplefilterdetectP = samplefilterdetectP,\r\n    samplefilterperc = samplefilterperc,\r\n    sitefilterdetectP = sitefilterdetectP,\r\n    locidiff = locidiff,\r\n    locidiffgroup = locidiffgroup,\r\n    XYchrom = XYchrom,\r\n    snpfilter = snpfilter\r\n)\r\n\r\n# site-level testing with the \"BH\" adjustment\r\nsitetest <- IMA2.sitetest(\r\n    dataf,\r\n    gcase = gcase,\r\n    gcontrol = gcontrol,\r\n    concov = concov,\r\n    testmethod = testmethod,\r\n    Padj = Padj,\r\n    rawpcut = rawpcut,\r\n    adjustpcut = adjustpcut,\r\n    betadiffcut = betadiffcut,\r\n    paired = paired\r\n)\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}